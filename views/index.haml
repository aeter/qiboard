!!!
%html
  %head
    %meta{charset: "UTF-8"}
    %title QIboard

    %link{rel: "stylesheet", href: "https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"}
    %script{src: "https://code.jquery.com/jquery-3.3.1.slim.min.js"}
    %script{src: "https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"}
    %script{src: "https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"}

    %link{rel: "stylesheet", href: "https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css"}
    %script{src: "http://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"}
    %script{src: "https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap4.min.js"}


    :javascript
      $(document).ready(function() {
        $('.datatables').DataTable({
          "aaSorting" : [] // don't sort any table column initially - unless sort arrow clicked
        });
      });
  %body
    %nav.navbar.navbar-dark.bg-dark
      %a{class: "navbar-brand", href: "#"} QIboard

    .card
      .card-header
        %form{method: "GET", action: "/"}
          .form-group
            %textarea.form-control{rows: "2", id: "query", name: "query"}
              = @query
            %input.btn.btn-primary{type: "submit", value: "Run Query"}
      .card-body
        - keys = @results&.first&.keys.to_a.sort.select { |x| !["feed_url", "created_at"].include?(x) }
        %table.table.table-bordered.table-striped.datatables
          %thead
            %tr
              - keys.each do |key|
                %th= key
          %tbody
            - @results.to_a.each do |r|
              %tr
                - keys.each do |key|
                  - if key == "content"
                    %td&= remove_html_tags(r[key])
                  - elsif key == "link"
                    %td
                      %a{href: r[key]}= "Link"
                  - else
                    %td= r[key]
